<h6>Importa richieste di trasporto</h6>
<form id="form" action="/request/import/{{data.id}}" method="post">

   <div class="d-flex d-flex-row mt-1">
      <div class="flex-grow-1">
         <label for="wbs" class="form-label">Attività</label>
         <select class="form-select" id="activity" name="activity" required>
            {{#eq data.id 0}}
               <option value="" selected>Seleziona un'attività</option>
            {{/eq}}
            {{#each data.list_activity}}
               <option value="{{id}}">{{description}} ({{internal_ref}})</option>
            {{/each}}
         </select>
      </div>
   </div>

   <div class="d-flex d-flex-row mt-1">
      <div class="flex-grow-1">
         <label for="request" class="form-label">Richieste di trasporto da importare</label>
         <textarea class="form-control" id="request" name="request" required></textarea>
      </div>
   </div>

   <!-- Save  & Cancel operation -->
   <div class="d-flex d-inline-row justify-content-center mt-2">
      <div class="spinner-border" role="status" id="wait" hidden>
      </div>
      <button type="button" class="btn btn-success me-1" id="import" onclick="importRequest();">
         <i class="bi bi-upload"></i>
      </button>
      <div id="cancel">
         <a href="/request" type="button" class="d-inline-flex btn btn-secondary">
            <i class="bi bi-x-square"></i>
         </a>
      </div>
   </div>
</form>
{{> Error}}

<script>
   function importRequest() {
      if(document.querySelector("#activity").value.length === 0) {
         document.querySelector(".toast-body").innerText = "Selezionare un'attività dalla lista";
         toast.show();
      }
      else if(document.querySelector("#request").value.length === 0) {
         document.querySelector(".toast-body").innerText = "Inserire almeno un richiesta di trasporto";
         toast.show();
      }
      else {
         document.querySelector("#import").hidden = true;
         document.querySelector("#cancel").hidden = true;
         document.querySelector("#wait").hidden = false;
         document.querySelector("#form").submit();
      }
   }
</script>